<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- <link rel="stylesheet" href=".\css\style.css" /> -->
  </head>
  <style>
      @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;200;300;400;500;600;700;800;900&display=swap');
      *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        color: white;
        font-family: 'Montserrat', sans-serif;
        font-family: 'Noto Sans KR', sans-serif;
      }
      .clearfix::after, .clearfix::before{
        content: "";
        display: block;
        clear: both;
      }

      body{
        background-color: black;
      }
      .titlebox{
        padding-bottom: 50px;
        border-bottom: solid 2px red;
        text-align: center;
      }

      .titlebox .title{
        padding-top: 100px;
        text-align: center;
        font-size: 4rem;
        position: relative;
      }
      .titlebox .title::before{
        content: "";
        border: solid 2px red;
        position: absolute;
        bottom: 35px;
        left: 785px;  
        width: 350px;
        transition: all 0.5s;
      }

      /* .tltlebox .title:hover::before{
        cursor: pointer;
        opacity: 0;
      } */

      .titlebox .sub_tit{
        font-size: 1.3rem;
        text-align: center;
        /* padding: 10px; */
        /* background-color: blue; */
      }
      .imageup{
        text-align: center;
        font-size: 2rem;
        padding: 50px 0px 10px 0;
      }

      .desc{
        text-align: center;
        margin-bottom: 50px;
      }

      .box{
        background-color: white;
        width: 70%;
        height: 50%;
        margin: 0 auto;
        /* opacity: 0.7; */
        padding: 30px 0 20px 0;
      }
      
      .formgroup{
        text-align: center;
      }
      
      .box .sort_tit{
        color: black;
        font-size: 1.5rem;
        margin-bottom: 30px;
        font-family: 'Noto Sans KR', sans-serif;
        font-weight: bold;
        text-align: center;
      }

      .sort, .trash, .trashempty{
        color: white;
        background-color: black;
        padding: 6px;
        border-radius: 10px;
        margin-bottom: 20px;
        cursor: pointer;
      }

      .trash_file{
        margin-bottom: 50px;
      }
      
      .trashempty{
        transition: all 0.2s;
        margin-top: 20px;
      }

      .trashempty:hover{
        background-color: red;
        border-color: red;
      }

      input{
        color: #888;
      }

      .custom-label{
        border: solid 2px black;
        cursor: pointer;
        padding: 7px;
        border-radius: 10px;
        font-size: 14px;
        display: inline-block;
        color: black;
        font-weight: bold;
      }


      .trash-icon {
            background-image: url('/static/trash.png'); /* 아이콘 이미지 경로 */
            width: 24px; /* 아이콘의 너비 */
            height: 24px; /* 아이콘의 높이 */
            background-size: contain; /* 이미지 크기를 요소에 맞게 조절 */
            display: inline-block; /* 인라인 요소로 표시 */
            vertical-align: middle; /* 수직 정렬 */
            margin-right: 5px; /* 우측 여백 */
            cursor: pointer; /* 마우스 커서를 포인터로 변경하여 클릭 가능하도록 설정 */
        }

        .filename{
          color: #888;
          margin-right: 50px;
        }

    </style>
  <body>
    <div class="titlebox">
      <h1 class="title">X-Remove</h1>
      <b class="sub_tit">당신의 이별을 정리해드립니다</b>
    </div>
    <h2 class="imageup">이미지 업로드</h2>
    <p class="desc">이별할 사람의 이미지를 업로드하세요.</p>
    <div class="box">
      <p class="sort_tit">이미지를 선택해주세요!</p>
      <div class="formgroup">
        <form id="uploadForm" class="formchoice" action="/upload_image" method="post" enctype="multipart/form-data">
          <input type="file" name="x_file" accept="image/png, image/jpeg"  id="file-upload" style="display: none;" onchange="displayFileName()"/>
          <label for="file-upload" class="custom-label">파일 선택</label>
          <span class="filename" id="file-name"></span>
          <input class="sort" type="submit" value="분류된 폴더에 저장" />
        </form>

        <form id="trashForm" class="formchoice" action="/move_to_trash" method="post" enctype="multipart/form-data">
          <input class="trash_file" type="file" name="x_file" accept="image/png, image/jpeg" id="file-upload2" style="display: none;" onchange="displayFileName2()" />
          <label for="file-upload2" class="custom-label">파일 선택</label>
          <span class="filename" id="file-name2"></span>
          <input class="trash" type="submit" value="휴지통으로 이동" />
        </form>

        <form id="emptyTrashButton" class="empty" action="/empty_trash" method="post">
          <label for="trash-icon" class="trash-icon"></label> <!-- 아이콘 추가 -->
          <input class="trashempty" type="submit" id="trash-icon" value="휴지통 비우기" /> <!-- 휴지통 비우기 버튼 -->
        </form>
      </div>
    </div>

    <script>
      // 선택한 파일 이름 표시
      function displayFileName() {
        const input = document.getElementById('file-upload');
        const fileNameSpan = document.getElementById('file-name');
        if (input.files.length > 0) {
          fileNameSpan.textContent = input.files[0].name;
        } else {
          fileNameSpan.textContent = '';
        }
      }
    </script>
    <script>
        // 선택한 파일 이름 표시
        function displayFileName2() {
          const input = document.getElementById('file-upload2');
          const fileNameSpan = document.getElementById('file-name2');
          if (input.files.length > 0) {
            fileNameSpan.textContent = input.files[0].name;
          } else {
            fileNameSpan.textContent = '';
          }
        }
      </script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const uploadForm = document.getElementById("uploadForm");
    uploadForm.onsubmit = async(e) => {
        e.preventDefault();
        // 파일이 선택되었는지 확인
        if (!uploadForm.x_file.files.length) {
            alert("파일을 선택해 주세요.");
            return; // 파일이 없으면 여기서 처리 중단
        }
        const formData = new FormData(uploadForm);
        try {
            const response = await fetch('/upload_image', {
                method: 'POST',
                body: formData,
            });
            const result = await response.json();
            if (response.ok) {
                alert("성공적으로 업로드 되었습니다.");
            } else if(response.status === 404) {
                alert("매칭되는 이미지가 없습니다.");
            } else {
                alert("사람 얼굴이 있는 이미지를 입력해 주세요.");
            }
        } catch (error) {
            console.error('Error:', error);
        }
    };
});
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    const trashForm = document.getElementById("trashForm");
    trashForm.onsubmit = async(e) => {
        e.preventDefault();
        // 파일이 선택되었는지 확인
        if (!trashForm.x_file.files.length) {
            alert("파일을 선택해 주세요.");
            return; // 파일이 없으면 여기서 처리 중단
        }
        const formData = new FormData(trashForm);
        try {
            const response = await fetch('/move_to_trash', {
                method: 'POST',
                body: formData,
            });
            const result = await response.json();
            if (response.ok) {
                alert("성공적으로 업로드 되었습니다.");
            } else if(response.status === 404) {
                alert("매칭되는 이미지가 없습니다.");
            } else {
                alert("사람 얼굴이 있는 이미지를 입력해 주세요.");
            }
        } catch (error) {
            console.error('Error:', error);
        }
    };
});
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const emptyTrashButton = document.getElementById("emptyTrashButton");
        emptyTrashButton.onclick = async (e) => {
            e.preventDefault();
            try {
                const response = await fetch('/empty_trash', {
                    method: 'POST',
                });
                const result = await response.json();
                if (response.ok) {
                    alert("휴지통이 성공적으로 비워졌습니다.");
                } else if(response.status === 404){
                    alert("이미 휴지통이 비어있습니다.");
                } else {
                    alert("휴지통을 비우는 데 실패했습니다. 다시 시도해 주세요.");
                }
            } catch (error) {
                console.error('Error:', error);
                alert("오류가 발생했습니다. 관리자에게 문의하세요.");
            }
        };
    });
    </script>


  </body>

</html>
